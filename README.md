# ğŸ¢ ç”µæ¢¯è‡ªè¡Œæ£€æµ‹å¤‡å¿˜å½•ç”µå­åŒ–ç³»ç»Ÿ

## ğŸ“– é¡¹ç›®ç®€ä»‹

ç°ä»£åŒ–çš„ç”µæ¢¯æ£€æµ‹å¤‡å¿˜å½•ç®¡ç†ç³»ç»Ÿï¼Œä¸“ä¸ºç”µæ¢¯æ£€æµ‹è¡Œä¸šè®¾è®¡ï¼Œå®Œå…¨æ›¿ä»£ä¼ ç»Ÿçº¸è´¨å¤‡å¿˜å½•æµç¨‹ã€‚

### âœ¨ æ ¸å¿ƒåŠŸèƒ½

- ğŸ” **ç”¨æˆ·ç®¡ç†** - ç®¡ç†å‘˜/æ™®é€šç”¨æˆ·è§’è‰²ï¼ŒJWTå®‰å…¨è®¤è¯
- ğŸ“‹ **å¤‡å¿˜å½•ç®¡ç†** - åˆ›å»ºã€ç¼–è¾‘ã€æŸ¥çœ‹ã€åˆ é™¤ã€å¤åˆ¶å¤‡å¿˜å½•
- âœï¸ **ç”µå­ç­¾å** - æ£€æµ‹äººå‘˜ç­¾åä¸Šä¼  + æ‰‹å†™ç”µå­ç­¾å
- ğŸ¯ **æƒé™æ§åˆ¶** - æ•°æ®éš”ç¦»ï¼Œç”¨æˆ·åªèƒ½ç®¡ç†è‡ªå·±çš„å¤‡å¿˜å½•
- ğŸ“„ **PDFå¯¼å‡º** - æ ‡å‡†æ ¼å¼PDFæ–‡æ¡£ç”Ÿæˆ
- ğŸ” **æ™ºèƒ½æœç´¢** - å¤šæ¡ä»¶æœç´¢å’Œåˆ†é¡µæ˜¾ç¤º
- ğŸ“± **å“åº”å¼è®¾è®¡** - æ”¯æŒPCã€å¹³æ¿ã€æ‰‹æœºå¤šç«¯è®¿é—®
- âš¡ **é«˜æ€§èƒ½** - ä¼˜åŒ–æ”¯æŒ10ä¸‡+å¤‡å¿˜å½•æ•°æ®

## ğŸ—ï¸ æŠ€æœ¯æ ˆ

### å‰ç«¯æŠ€æœ¯
- **Vue.js 3** + Composition API - ç°ä»£åŒ–å‰ç«¯æ¡†æ¶
- **Element Plus 2** - ä¼ä¸šçº§UIç»„ä»¶åº“
- **Vite 4** - å¿«é€Ÿæ„å»ºå·¥å…·
- **Vue Router 4** - å•é¡µè·¯ç”±ç®¡ç†
- **vue-signature-pad** - ç”µå­ç­¾åç»„ä»¶

### åç«¯æŠ€æœ¯
- **Node.js 18** - æœåŠ¡ç«¯è¿è¡Œç¯å¢ƒ
- **Express.js** - Webåº”ç”¨æ¡†æ¶
- **JWT + bcrypt** - å®‰å…¨è®¤è¯
- **Puppeteer** - PDFæ–‡æ¡£ç”Ÿæˆ
- **Multer** - æ–‡ä»¶ä¸Šä¼ å¤„ç†
- **node-cron** - å®šæ—¶ä»»åŠ¡è°ƒåº¦

### æ•°æ®åº“ä¸å­˜å‚¨
- **PostgreSQL 15** - å…³ç³»å‹æ•°æ®åº“
- **æ–‡ä»¶ç³»ç»Ÿ** - ç­¾åå›¾ç‰‡æœ¬åœ°å­˜å‚¨

## ğŸ“ é¡¹ç›®ç»“æ„

```
elevator-memo-system/
â”œâ”€â”€ ğŸ“ frontend/              # Vue.js å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ api/              # APIæ¥å£å°è£…
â”‚   â”‚   â”œâ”€â”€ components/       # å¯å¤ç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ views/            # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ router/           # è·¯ç”±é…ç½®
â”‚   â”‚   â”œâ”€â”€ stores/           # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â””â”€â”€ utils/            # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ Dockerfile.production # å‰ç«¯ç”Ÿäº§ç¯å¢ƒé•œåƒ
â”‚
â”œâ”€â”€ ğŸ“ backend/               # Node.js åç«¯API
â”‚   â”œâ”€â”€ controllers/          # ä¸šåŠ¡æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ middleware/           # ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ models/               # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ routes/               # è·¯ç”±å®šä¹‰
â”‚   â”œâ”€â”€ templates/            # PDFæ¨¡æ¿
â”‚   â”œâ”€â”€ utils/                # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ Dockerfile.production # åç«¯ç”Ÿäº§ç¯å¢ƒé•œåƒ
â”‚
â”œâ”€â”€ ğŸ“ database/              # æ•°æ®åº“è„šæœ¬
â”‚   â””â”€â”€ schema.sql            # æ•°æ®åº“æ¶æ„
â”‚
â”œâ”€â”€ ğŸ“ deploy/                # éƒ¨ç½²è„šæœ¬
â”‚   â”œâ”€â”€ docker-deploy.sh      # Dockerä¸€é”®éƒ¨ç½²
â”‚   â””â”€â”€ production-deploy.sh  # ä¼ ç»ŸæœåŠ¡å™¨éƒ¨ç½²
â”‚
â”œâ”€â”€ ğŸ“ nginx/                 # Nginxé…ç½®
â”‚   â””â”€â”€ sites/                # ç«™ç‚¹é…ç½®
â”‚
â”œâ”€â”€ docker-compose.production.yml # Dockerç¼–æ’é…ç½®
â”œâ”€â”€ start-dev.bat            # å¼€å‘ç¯å¢ƒå¯åŠ¨(Windows)
â”œâ”€â”€ start-dev.sh             # å¼€å‘ç¯å¢ƒå¯åŠ¨(Linux/Mac)
â””â”€â”€ README.md               # é¡¹ç›®æ–‡æ¡£
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ğŸ”§ ç¯å¢ƒè¦æ±‚

- **Node.js** 18.0+
- **PostgreSQL** 15+
- **Docker** & **Docker Compose** (æ¨è)

### ğŸ“¦ ä¸€é”®éƒ¨ç½²

### ğŸš€ ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²ï¼ˆæ¨èï¼‰

#### Windows ç³»ç»Ÿéƒ¨ç½²
```batch
# 1. é…ç½®ç¯å¢ƒå˜é‡ï¼ˆé¦–æ¬¡éƒ¨ç½²å¿…é¡»ï¼‰
copy .env.production.example .env.production
# ç¼–è¾‘ .env.production è®¾ç½®æ•°æ®åº“å¯†ç ã€JWTå¯†é’¥ç­‰

# 2. ä¸€é”®éƒ¨ç½²ï¼ˆä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œï¼‰
deploy-windows.bat
```

#### Linux ç³»ç»Ÿéƒ¨ç½²
```bash
# 1. é…ç½®ç¯å¢ƒå˜é‡ï¼ˆé¦–æ¬¡éƒ¨ç½²å¿…é¡»ï¼‰
cp .env.production.example .env.production
nano .env.production  # ä¿®æ”¹æ•°æ®åº“å¯†ç ã€JWTå¯†é’¥ç­‰

# 2. ä¸€é”®éƒ¨ç½²ï¼ˆéœ€è¦rootæƒé™ï¼‰
sudo chmod +x deploy-linux.sh
sudo ./deploy-linux.sh
```

### ğŸ› ï¸ å¼€å‘ç¯å¢ƒå¯åŠ¨

#### æ–¹å¼ä¸€ï¼šå¿«é€Ÿå¯åŠ¨è„šæœ¬
```bash
# Windows
start-dev.bat

# Linux/Mac  
./start-dev.sh
```

#### æ–¹å¼äºŒï¼šæ‰‹åŠ¨å¯åŠ¨
```bash
# 1. å®‰è£… PostgreSQL å¹¶åˆ›å»ºæ•°æ®åº“
createdb elevator_memo
psql -d elevator_memo -f database/schema.sql

# 2. åç«¯å¯åŠ¨
cd backend
npm install
cp .env.example .env  # é…ç½®æ•°æ®åº“è¿æ¥
npm run dev

# 3. å‰ç«¯å¯åŠ¨ (æ–°ç»ˆç«¯)
cd frontend
npm install
npm run dev
```

### ğŸŒ è®¿é—®ç³»ç»Ÿ

- **å‰ç«¯ç•Œé¢**: http://localhost:8080 (å¼€å‘) / http://localhost (ç”Ÿäº§)
- **åç«¯API**: http://localhost:3000/api
- **é»˜è®¤ç®¡ç†å‘˜**: `admin` / `admin123`

## ğŸ”Œ ä¸»è¦APIæ¥å£

### ğŸ” ç”¨æˆ·è®¤è¯
- `POST /api/users/login` - ç”¨æˆ·ç™»å½•
- `GET /api/users/me` - è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
- `PUT /api/users/me` - æ›´æ–°ä¸ªäººèµ„æ–™

### ğŸ“‹ å¤‡å¿˜å½•ç®¡ç†
- `GET /api/memos` - è·å–å¤‡å¿˜å½•åˆ—è¡¨ï¼ˆæ”¯æŒæœç´¢åˆ†é¡µï¼‰
- `POST /api/memos` - åˆ›å»ºæ–°å¤‡å¿˜å½•
- `GET /api/memos/:id` - è·å–å¤‡å¿˜å½•è¯¦æƒ…
- `PUT /api/memos/:id` - æ›´æ–°å¤‡å¿˜å½•
- `DELETE /api/memos/:id` - åˆ é™¤å¤‡å¿˜å½•
- `GET /api/memos/:id/pdf` - å¯¼å‡ºPDF

### ğŸ‘¥ ç”¨æˆ·ç®¡ç†ï¼ˆç®¡ç†å‘˜ï¼‰
- `GET /api/users` - è·å–ç”¨æˆ·åˆ—è¡¨
- `POST /api/users` - åˆ›å»ºæ–°ç”¨æˆ·
- `PUT /api/users/:id` - æ›´æ–°ç”¨æˆ·ä¿¡æ¯

### ğŸ“ æ–‡ä»¶ä¸Šä¼ 
- `POST /api/upload/tester-signature` - ä¸Šä¼ æ£€æµ‹äººå‘˜ç­¾å

## ğŸ—ï¸ éƒ¨ç½²æ¶æ„è¯´æ˜

### ğŸ“‹ ç³»ç»Ÿè¦æ±‚

#### æœ€ä½é…ç½®è¦æ±‚
- **CPU**: 2æ ¸å¿ƒä»¥ä¸Š
- **å†…å­˜**: 2GBä»¥ä¸Šï¼ˆæ¨è4GBï¼‰
- **å­˜å‚¨**: 10GBå¯ç”¨ç©ºé—´ï¼ˆSSDæ¨èï¼‰
- **ç½‘ç»œ**: ç¨³å®šçš„äº’è”ç½‘è¿æ¥

#### æ”¯æŒçš„æ“ä½œç³»ç»Ÿ
- **Windows**: Windows 10/11, Windows Server 2019/2022
- **Linux**: Ubuntu 20.04+, CentOS 8+, Debian 11+, Rocky Linux 8+

### ğŸ›ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Nginx Proxy   â”‚â”€â”€â”€â–¶â”‚  Frontend (Vue) â”‚    â”‚ Backend (Node)  â”‚
â”‚   (Port 80)     â”‚    â”‚   (Port 8080)   â”‚â—€â”€â”€â–¶â”‚  (Port 3000)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                        â”‚
                                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                               â”‚  PostgreSQL DB  â”‚
                                               â”‚   (Port 5432)   â”‚
                                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

æ ¸å¿ƒæœåŠ¡ç»„ä»¶ï¼š
- **Nginx**: åå‘ä»£ç†ã€è´Ÿè½½å‡è¡¡ã€é™æ€èµ„æºæœåŠ¡
- **Frontend**: Vue.js 3 + Element Plus å‰ç«¯åº”ç”¨
- **Backend**: Node.js + Express API æœåŠ¡
- **Database**: PostgreSQL 15 æ•°æ®åº“

### ğŸ³ Docker å®¹å™¨åŒ–éƒ¨ç½²è¯¦è§£

#### ç¯å¢ƒè¦æ±‚éªŒè¯
```bash
# æ£€æŸ¥ Docker ç‰ˆæœ¬
docker --version          # éœ€è¦ 20.10+
docker-compose --version   # éœ€è¦ 2.0+

# æ£€æŸ¥ç³»ç»Ÿèµ„æº
free -h                   # æŸ¥çœ‹å†…å­˜
df -h                     # æŸ¥çœ‹ç£ç›˜ç©ºé—´
```

#### éƒ¨ç½²é…ç½®è¯´æ˜

**ç¯å¢ƒå˜é‡é…ç½®** (`.env.production`)ï¼š
```env
# æ•°æ®åº“å®‰å…¨é…ç½®ï¼ˆå¿…é¡»ä¿®æ”¹ï¼‰
DB_PASSWORD=YourSecurePassword123!

# JWT å®‰å…¨å¯†é’¥ï¼ˆå¿…é¡»ä¿®æ”¹ï¼Œè‡³å°‘32å­—ç¬¦ï¼‰
JWT_SECRET=your_jwt_secret_key_minimum_32_characters

# å¯é€‰é…ç½®
DOMAIN_NAME=yourdomain.com
ADMIN_EMAIL=admin@yourdomain.com
ENABLE_SSL=true
BACKUP_SCHEDULE="0 2 * * *"
```

**å®¹å™¨èµ„æºé™åˆ¶**ï¼š
- Backend: 512MBå†…å­˜é™åˆ¶, 1CPUæ ¸å¿ƒ
- Frontend: 128MBå†…å­˜é™åˆ¶, 0.5CPUæ ¸å¿ƒ  
- PostgreSQL: æ ¹æ®æ•°æ®é‡è‡ªåŠ¨è°ƒæ•´
- Nginx: 256MBå†…å­˜é™åˆ¶

#### Docker ç½‘ç»œå’Œå­˜å‚¨

**æŒä¹…åŒ–æ•°æ®å·**ï¼š
- `postgres_data`: æ•°æ®åº“æ–‡ä»¶
- `uploads_data`: ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶
- `backend_logs`: åç«¯æ—¥å¿—
- `nginx_logs`: WebæœåŠ¡å™¨æ—¥å¿—

**ç½‘ç»œé…ç½®**ï¼š
- å†…éƒ¨ç½‘ç»œ: `172.20.0.0/16`
- æœåŠ¡é—´é€šä¿¡é€šè¿‡å®¹å™¨åç§°
- å¯¹å¤–æš´éœ²ç«¯å£: 80 (Nginx), 3000 (Backend), 8080 (Frontend)

### ğŸ–¥ï¸ ä¼ ç»ŸæœåŠ¡å™¨éƒ¨ç½²è¯¦è§£

#### é€‚ç”¨åœºæ™¯
- æ— æ³•ä½¿ç”¨Dockerçš„ä¼ä¸šç¯å¢ƒ
- éœ€è¦æ›´ç²¾ç»†çš„æœåŠ¡å™¨æ§åˆ¶
- å·²æœ‰PostgreSQL/Nginxç­‰åŸºç¡€è®¾æ–½

#### ç³»ç»Ÿä¾èµ–å®‰è£…

**Ubuntu/Debian ç³»ç»Ÿ**:
```bash
# æ›´æ–°åŒ…åˆ—è¡¨
sudo apt update && sudo apt upgrade -y

# å®‰è£… Node.js 18
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt install -y nodejs

# å®‰è£… PostgreSQL 15
sudo apt install -y postgresql-15 postgresql-client-15

# å®‰è£… Nginx å’Œ PM2
sudo apt install -y nginx
sudo npm install -g pm2

# å®‰è£… Gitï¼ˆå¦‚æœéœ€è¦ï¼‰
sudo apt install -y git
```

**CentOS/RHEL ç³»ç»Ÿ**:
```bash
# å®‰è£… EPEL ä»“åº“
sudo dnf install -y epel-release

# å®‰è£… Node.js 18
curl -fsSL https://rpm.nodesource.com/setup_18.x | sudo bash -
sudo dnf install -y nodejs

# å®‰è£… PostgreSQL 15
sudo dnf install -y postgresql15-server postgresql15
sudo /usr/pgsql-15/bin/postgresql-15-setup initdb
sudo systemctl enable postgresql-15
sudo systemctl start postgresql-15

# å®‰è£… Nginx å’Œ PM2
sudo dnf install -y nginx
sudo npm install -g pm2
```

#### æ•°æ®åº“åˆå§‹åŒ–è¯¦è§£
```bash
# åˆ‡æ¢åˆ° postgres ç”¨æˆ·
sudo su - postgres

# åˆ›å»ºåº”ç”¨ç”¨æˆ·å’Œæ•°æ®åº“
createuser -P -s elevator_user  # è¾“å…¥å¯†ç : your_db_password
createdb -O elevator_user elevator_memo

# éªŒè¯è¿æ¥
psql -U elevator_user -d elevator_memo -c "\l"

# å¯¼å…¥æ•°æ®åº“æ¶æ„
psql -U elevator_user -d elevator_memo -f /path/to/database/schema.sql

# é€€å‡º postgres ç”¨æˆ·
exit
```

#### PM2 è¿›ç¨‹ç®¡ç†é…ç½®
```bash
# ç”Ÿäº§ç¯å¢ƒå¯åŠ¨
cd backend
pm2 start ecosystem.config.js --env production

# ä¿å­˜ PM2 é…ç½®
pm2 save

# è®¾ç½®å¼€æœºè‡ªå¯
pm2 startup  # æŒ‰æç¤ºæ‰§è¡Œè¿”å›çš„å‘½ä»¤

# ç›‘æ§æœåŠ¡çŠ¶æ€
pm2 monit
```

#### Nginx è¯¦ç»†é…ç½®
```bash
# å¤åˆ¶é…ç½®æ–‡ä»¶
sudo cp nginx/sites/elevator-memo.conf /etc/nginx/sites-available/

# å¯ç”¨ç«™ç‚¹
sudo ln -s /etc/nginx/sites-available/elevator-memo.conf /etc/nginx/sites-enabled/

# åˆ é™¤é»˜è®¤é…ç½®ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
sudo rm -f /etc/nginx/sites-enabled/default

# æµ‹è¯•é…ç½®
sudo nginx -t

# é‡æ–°åŠ è½½é…ç½®
sudo systemctl reload nginx
sudo systemctl enable nginx
```

#### æ€§èƒ½è°ƒä¼˜å»ºè®®
```bash
# Node.js å†…å­˜ä¼˜åŒ–
export NODE_OPTIONS="--max-old-space-size=4096"

# PostgreSQL é…ç½®ä¼˜åŒ– (/etc/postgresql/15/main/postgresql.conf)
shared_buffers = 256MB
effective_cache_size = 1GB
work_mem = 4MB
maintenance_work_mem = 64MB
max_connections = 100
```

#### å®‰å…¨é…ç½®å¼ºåŒ–
```bash
# é˜²ç«å¢™é…ç½®
sudo ufw allow 22         # SSH
sudo ufw allow 80         # HTTP  
sudo ufw allow 443        # HTTPS
sudo ufw deny 3000        # é˜»æ­¢ç›´æ¥è®¿é—®åç«¯
sudo ufw deny 5432        # é˜»æ­¢ç›´æ¥è®¿é—®æ•°æ®åº“
sudo ufw enable

# æ–‡ä»¶æƒé™è®¾ç½®
chmod 600 .env.production
chmod 755 backend/uploads/
chown -R www-data:www-data /var/www/html/

# SSL è¯ä¹¦é…ç½®ï¼ˆæ¨èä½¿ç”¨ Let's Encryptï¼‰
sudo apt install certbot python3-certbot-nginx
sudo certbot --nginx -d yourdomain.com
```

#### è‡ªåŠ¨åŒ–å¤‡ä»½è„šæœ¬
```bash
# åˆ›å»ºå¤‡ä»½è„šæœ¬ /usr/local/bin/backup-elevator-memo.sh
#!/bin/bash
BACKUP_DIR="/opt/backups/elevator-memo"
DATE=$(date +%Y%m%d_%H%M%S)

# åˆ›å»ºå¤‡ä»½ç›®å½•
mkdir -p $BACKUP_DIR

# æ•°æ®åº“å¤‡ä»½
pg_dump -U elevator_user -h localhost elevator_memo | gzip > $BACKUP_DIR/db_backup_$DATE.sql.gz

# æ–‡ä»¶å¤‡ä»½
tar -czf $BACKUP_DIR/uploads_backup_$DATE.tar.gz backend/uploads/

# æ¸…ç†7å¤©å‰çš„å¤‡ä»½
find $BACKUP_DIR -name "*.gz" -mtime +7 -delete

echo "å¤‡ä»½å®Œæˆ: $DATE"
```

```bash
# è®¾ç½®å®šæ—¶å¤‡ä»½ï¼ˆæ¯æ—¥å‡Œæ™¨2ç‚¹ï¼‰
sudo crontab -e
# æ·»åŠ ä»¥ä¸‹è¡Œ:
0 2 * * * /usr/local/bin/backup-elevator-memo.sh >> /var/log/backup.log 2>&1
```

## ğŸ”§ éƒ¨ç½²åç®¡ç†

### ğŸ“Š æœåŠ¡ç›‘æ§

#### å®æ—¶çŠ¶æ€ç›‘æ§
```bash
# Docker éƒ¨ç½²ç›‘æ§
docker-compose -f docker-compose.production.yml ps
docker stats

# ä¼ ç»Ÿéƒ¨ç½²ç›‘æ§
pm2 status
pm2 monit           # å®æ—¶ç›‘æ§ç•Œé¢
systemctl status nginx postgresql
```

#### æ—¥å¿—ç®¡ç†
```bash
# Docker éƒ¨ç½²æ—¥å¿—
docker-compose -f docker-compose.production.yml logs -f          # æ‰€æœ‰æœåŠ¡
docker-compose -f docker-compose.production.yml logs -f backend  # åç«¯æ—¥å¿—
docker-compose -f docker-compose.production.yml logs -f frontend # å‰ç«¯æ—¥å¿—

# ä¼ ç»Ÿéƒ¨ç½²æ—¥å¿—
pm2 logs --lines 100          # PM2 åº”ç”¨æ—¥å¿—
tail -f /var/log/nginx/access.log  # Nginx è®¿é—®æ—¥å¿—
tail -f /var/log/nginx/error.log   # Nginx é”™è¯¯æ—¥å¿—
journalctl -u postgresql -f        # PostgreSQL æ—¥å¿—
```

#### å¥åº·æ£€æŸ¥è„šæœ¬
```bash
#!/bin/bash
# ä¿å­˜ä¸º health-check.sh

echo "=== ç”µæ¢¯å¤‡å¿˜å½•ç³»ç»Ÿå¥åº·æ£€æŸ¥ ==="

# æ£€æŸ¥ API å¥åº·çŠ¶æ€
if curl -sf http://localhost:3000 &>/dev/null; then
    echo "âœ“ åç«¯ API æœåŠ¡æ­£å¸¸"
else
    echo "âœ— åç«¯ API æœåŠ¡å¼‚å¸¸"
fi

# æ£€æŸ¥å‰ç«¯æœåŠ¡
if curl -sf http://localhost:8080 &>/dev/null; then
    echo "âœ“ å‰ç«¯æœåŠ¡æ­£å¸¸"
else
    echo "âœ— å‰ç«¯æœåŠ¡å¼‚å¸¸"
fi

# æ£€æŸ¥æ•°æ®åº“è¿æ¥
if docker exec elevator-memo-postgres pg_isready -U elevator_user &>/dev/null; then
    echo "âœ“ æ•°æ®åº“è¿æ¥æ­£å¸¸"
else
    echo "âœ— æ•°æ®åº“è¿æ¥å¼‚å¸¸"
fi

# æ£€æŸ¥ç£ç›˜ç©ºé—´
DISK_USAGE=$(df / | awk 'NR==2 {print $5}' | sed 's/%//')
if [ $DISK_USAGE -lt 90 ]; then
    echo "âœ“ ç£ç›˜ç©ºé—´å……è¶³ ($DISK_USAGE%)"
else
    echo "âš  ç£ç›˜ç©ºé—´ä¸è¶³ ($DISK_USAGE%)"
fi

# æ£€æŸ¥å†…å­˜ä½¿ç”¨
MEM_USAGE=$(free | awk 'NR==2{printf "%.1f", $3*100/$2}')
echo "ğŸ“Š å†…å­˜ä½¿ç”¨ç‡: ${MEM_USAGE}%"
```

### âš¡ å¸¸ç”¨ç®¡ç†å‘½ä»¤

#### Docker éƒ¨ç½²ç®¡ç†
```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose -f docker-compose.production.yml ps

# é‡å¯ç‰¹å®šæœåŠ¡
docker-compose -f docker-compose.production.yml restart backend
docker-compose -f docker-compose.production.yml restart frontend

# æ›´æ–°æœåŠ¡ï¼ˆæœ‰æ–°ä»£ç æ—¶ï¼‰
docker-compose -f docker-compose.production.yml build backend
docker-compose -f docker-compose.production.yml up -d backend

# æ•°æ®åº“å¤‡ä»½
docker exec elevator-memo-postgres pg_dump -U elevator_user elevator_memo > backup_$(date +%Y%m%d).sql

# æŸ¥çœ‹èµ„æºä½¿ç”¨
docker stats
```

#### ä¼ ç»Ÿéƒ¨ç½²ç®¡ç†
```bash
# PM2 åº”ç”¨ç®¡ç†
pm2 restart elevator-memo-backend
pm2 reload elevator-memo-backend
pm2 stop elevator-memo-backend
pm2 delete elevator-memo-backend

# Nginx é…ç½®ç®¡ç†
sudo nginx -t                    # æµ‹è¯•é…ç½®
sudo systemctl reload nginx      # é‡è½½é…ç½®
sudo systemctl restart nginx     # é‡å¯æœåŠ¡

# æ•°æ®åº“ç®¡ç†
sudo systemctl status postgresql-15
sudo -u postgres psql elevator_memo
```

### ğŸš¨ æ•…éšœæ’é™¤æŒ‡å—

#### é—®é¢˜1: æœåŠ¡æ— æ³•å¯åŠ¨
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tlnp | grep -E ':(80|3000|5432|8080)'
# æˆ–ä½¿ç”¨ ss å‘½ä»¤
ss -tlnp | grep -E ':(80|3000|5432|8080)'

# è§£å†³æ–¹æ¡ˆ: åœæ­¢å ç”¨ç«¯å£çš„è¿›ç¨‹æˆ–ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„ç«¯å£
```

#### é—®é¢˜2: æ•°æ®åº“è¿æ¥å¤±è´¥
```bash
# Docker ç¯å¢ƒ
docker logs elevator-memo-postgres
docker exec -it elevator-memo-postgres psql -U elevator_user -d elevator_memo

# ä¼ ç»Ÿç¯å¢ƒ  
sudo systemctl status postgresql
sudo -u postgres psql -l
psql -U elevator_user -d elevator_memo -c "SELECT version();"

# å¸¸è§è§£å†³æ–¹æ¡ˆ:
# 1. æ£€æŸ¥ .env.production ä¸­çš„æ•°æ®åº“é…ç½®
# 2. ç¡®è®¤æ•°æ®åº“ç”¨æˆ·æƒé™: GRANT ALL PRIVILEGES ON DATABASE elevator_memo TO elevator_user;
# 3. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
```

#### é—®é¢˜3: PDF ç”Ÿæˆå¤±è´¥
```bash
# Docker: æ£€æŸ¥ Chromium
docker exec elevator-memo-backend chromium-browser --version
docker exec elevator-memo-backend ls -la /usr/bin/chromium-browser

# ä¼ ç»Ÿéƒ¨ç½²: å®‰è£… Chrome/Chromium
# Ubuntu/Debian:
wget -q -O - https://dl.google.com/linux/linux_signing_key.pub | sudo apt-key add -
sudo apt install google-chrome-stable

# CentOS/RHEL:
sudo yum install -y google-chrome-stable
```

#### é—®é¢˜4: æ–‡ä»¶ä¸Šä¼ å¤±è´¥
```bash
# æ£€æŸ¥ä¸Šä¼ ç›®å½•
ls -la backend/uploads/
chmod 755 backend/uploads/
chmod 755 backend/uploads/signatures/

# Docker ç¯å¢ƒæ£€æŸ¥å·æŒ‚è½½
docker volume inspect elevator-memo-system_uploads_data
docker exec elevator-memo-backend ls -la /app/uploads/
```

#### é—®é¢˜5: å‰ç«¯é¡µé¢ç©ºç™½æˆ–404
```bash
# æ£€æŸ¥å‰ç«¯æ„å»ºçŠ¶æ€
docker logs elevator-memo-frontend
curl -I http://localhost:8080

# æ£€æŸ¥ API è¿æ¥é…ç½®
grep VITE_API_BASE_URL frontend/.env.production
curl http://localhost:3000/api/health

# æŸ¥çœ‹æµè§ˆå™¨å¼€å‘è€…å·¥å…·ç½‘ç»œå’Œæ§åˆ¶å°é€‰é¡¹å¡çš„é”™è¯¯ä¿¡æ¯
```

#### é—®é¢˜6: æ€§èƒ½é—®é¢˜
```bash
# ç›‘æ§èµ„æºä½¿ç”¨
docker stats                    # Docker ç¯å¢ƒ
htop                           # ä¼ ç»Ÿç¯å¢ƒ

# æ•°æ®åº“æ€§èƒ½åˆ†æ
docker exec elevator-memo-postgres psql -U elevator_user -d elevator_memo -c "
SELECT schemaname,tablename,attname,n_distinct,correlation 
FROM pg_stats WHERE tablename='memos';"

# ä¼˜åŒ–å»ºè®®:
# 1. å¢åŠ æ•°æ®åº“è¿æ¥æ± : backend/config/database.js
# 2. å¯ç”¨ Redis ç¼“å­˜
# 3. é…ç½® CDN åŠ é€Ÿé™æ€èµ„æº
```

## ğŸ“Š æ€§èƒ½ç‰¹æ€§

- **é«˜å¹¶å‘**: æ”¯æŒ50+ ç”¨æˆ·åŒæ—¶åœ¨çº¿
- **å¤§æ•°æ®é‡**: ä¼˜åŒ–æ”¯æŒ10ä¸‡+ å¤‡å¿˜å½•
- **å¿«é€Ÿå“åº”**: æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–ï¼ŒAPIå“åº”<200ms
- **è‡ªåŠ¨æ¸…ç†**: å®šæ—¶æ¸…ç†è¿‡æœŸæ–‡ä»¶ï¼ŒèŠ‚çœå­˜å‚¨ç©ºé—´

### ğŸ”’ å®‰å…¨å»ºè®®

#### ç”Ÿäº§ç¯å¢ƒå®‰å…¨æ¸…å•
- [ ] ä¿®æ”¹é»˜è®¤å¯†ç ï¼š`.env.production` ä¸­çš„ `DB_PASSWORD` å’Œ `JWT_SECRET`
- [ ] å¯ç”¨é˜²ç«å¢™ï¼šä»…å¼€æ”¾å¿…è¦ç«¯å£ (80, 443, 22)
- [ ] é…ç½® SSL è¯ä¹¦ï¼šä½¿ç”¨ Let's Encrypt æˆ–å•†ä¸šè¯ä¹¦
- [ ] å®šæœŸæ›´æ–°ï¼šä¿æŒç³»ç»Ÿå’Œä¾èµ–åŒ…ä¸ºæœ€æ–°ç‰ˆæœ¬
- [ ] å¤‡ä»½ç­–ç•¥ï¼šé…ç½®è‡ªåŠ¨æ•°æ®åº“å’Œæ–‡ä»¶å¤‡ä»½
- [ ] æ—¥å¿—ç›‘æ§ï¼šé…ç½®æ—¥å¿—è½®æ¢å’Œç›‘æ§å‘Šè­¦

#### æ•°æ®å®‰å…¨
```bash
# æ•°æ®åº“åŠ å¯†è¿æ¥ï¼ˆæ¨èï¼‰
# åœ¨ .env.production ä¸­æ·»åŠ :
DB_SSL=true

# æ–‡ä»¶æƒé™å¼ºåŒ–
chmod 600 .env.production
chmod 700 backend/logs/
chmod 755 backend/uploads/

# å®šæœŸå®‰å…¨æ‰«æ
docker scan elevator-memo-backend  # Dockeré•œåƒå®‰å…¨æ‰«æ
npm audit                         # Node.jsä¾èµ–å®‰å…¨æ£€æŸ¥
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–æŒ‡å—

### é«˜è´Ÿè½½ä¼˜åŒ–é…ç½®
```bash
# Node.js é›†ç¾¤æ¨¡å¼ (ecosystem.config.js)
instances: "max"          # ä½¿ç”¨æ‰€æœ‰CPUæ ¸å¿ƒ
exec_mode: "cluster"      # é›†ç¾¤æ¨¡å¼

# PostgreSQL æ€§èƒ½è°ƒä¼˜
shared_buffers = 512MB    # å¢åŠ å…±äº«ç¼“å†²åŒº
max_connections = 200     # å¢åŠ æœ€å¤§è¿æ¥æ•°
effective_cache_size = 2GB
work_mem = 8MB

# Nginx å¹¶å‘ä¼˜åŒ–
worker_processes auto;
worker_connections 2048;
keepalive_requests 1000;
```

### ç›‘æ§å‘Šè­¦è®¾ç½®
```bash
# åˆ›å»ºç›‘æ§è„šæœ¬ /usr/local/bin/monitor-elevator-memo.sh
#!/bin/bash
# æ£€æŸ¥å…³é”®æŒ‡æ ‡å¹¶å‘é€å‘Šè­¦
CPU_USAGE=$(top -bn1 | grep "Cpu(s)" | awk '{print $2}' | cut -d'%' -f1)
MEM_USAGE=$(free | awk 'NR==2{printf "%.1f", $3*100/$2}')
DISK_USAGE=$(df / | awk 'NR==2 {print $5}' | sed 's/%//')

if (( $(echo "$CPU_USAGE > 80" | bc -l) )) || \
   (( $(echo "$MEM_USAGE > 80" | bc -l) )) || \
   [ $DISK_USAGE -gt 90 ]; then
    echo "ç³»ç»Ÿèµ„æºå‘Šè­¦: CPU:${CPU_USAGE}%, å†…å­˜:${MEM_USAGE}%, ç£ç›˜:${DISK_USAGE}%"
    # è¿™é‡Œå¯ä»¥æ·»åŠ é‚®ä»¶æˆ–webhooké€šçŸ¥
fi
```

## ğŸ†˜ æŠ€æœ¯æ”¯æŒ

### æ—¥å¿—æ”¶é›†å’Œåˆ†æ
```bash
# æ”¶é›†å®Œæ•´æ—¥å¿—ä¿¡æ¯ï¼ˆé—®é¢˜æŠ¥å‘Šæ—¶ä½¿ç”¨ï¼‰
./collect-logs.sh > system-logs-$(date +%Y%m%d).txt
```

### å¸¸è§é—®é¢˜å¿«é€Ÿè§£å†³
1. **æ— æ³•è®¿é—®ç³»ç»Ÿ** â†’ è¿è¡Œå¥åº·æ£€æŸ¥: `./health-check.sh`
2. **æ€§èƒ½ç¼“æ…¢** â†’ æŸ¥çœ‹èµ„æºç›‘æ§: `docker stats` æˆ– `htop`
3. **æ•°æ®ä¸¢å¤±** â†’ æŸ¥çœ‹å¤‡ä»½: `ls -la /opt/backups/elevator-memo/`
4. **æœåŠ¡å´©æºƒ** â†’ æŸ¥çœ‹æ—¥å¿—: `docker-compose -f docker-compose.production.yml logs`

## ğŸ“ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ï¼Œè¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Request æ¥å¸®åŠ©æ”¹è¿›é¡¹ç›®ï¼