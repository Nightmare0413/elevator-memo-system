<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>电梯自行检测备忘录</title>
    <style>
        @page {
            margin: 15mm;
            size: A4;
        }
        
        body {
            font-family: 'WenQuanYi Zen Hei', 'SimSun', '宋体', serif;
            font-size: 12pt;
            line-height: 1.4;
            margin: 0;
            padding: 20px;
            color: #000;
            background: white;
        }
        
        .document {
            width: 100%;
            max-width: 210mm;
            margin: 0 auto;
            background: white;
        }
        
        .header {
            text-align: center;
            margin-bottom: 15px;
        }
        
        .header h1 {
            font-family: 'WenQuanYi Zen Hei', 'SimHei', '黑体', sans-serif;
            font-size: 18pt;
            font-weight: bold;
            margin: 0 0 5px 0;
            letter-spacing: 3px;
        }
        
        .memo-number {
            text-align: right;
            margin: 10px 0 20px 0;
            font-size: 14px;
        }
        
        .main-table {
            width: 100%;
            border: 2px solid #000;
            border-collapse: collapse;
            margin-bottom: 0;
        }
        
        .main-table td {
            border: 1px solid #000;
            padding: 8px 10px;
            vertical-align: middle;
            height: auto;
            min-height: 30px;
            word-wrap: break-word;
            word-break: break-all;
            overflow-wrap: break-word;
            white-space: normal;
        }
        
        .label-cell {
            text-align: center;
            font-weight: normal;
            width: 18%;
            background-color: transparent;
        }
        
        .value-cell {
            padding-left: 15px;
            word-wrap: break-word;
            word-break: break-all;
            overflow-wrap: break-word;
        }
        
        /* 第一行 */
        .row-single {
            height: auto;
            min-height: 40px;
        }
        
        .row-single td {
            word-wrap: break-word;
            word-break: break-all;
            overflow-wrap: break-word;
        }
        
        /* 第二、三行的半格 */
        .half-cell {
            width: 35%;
            word-wrap: break-word;
            word-break: break-all;
            overflow-wrap: break-word;
        }
        
        .half-label {
            width: 15%;
            text-align: center;
        }
        
        .half-label-wide {
            width: 18%;
            text-align: center;
        }
        
        .half-cell-narrow {
            width: 32%;
            word-wrap: break-word;
            word-break: break-all;
            overflow-wrap: break-word;
        }
        
        /* 检测依据行 */
        .detection-basis-row td {
            height: auto;
            min-height: 40px;
            padding: 8px 15px;
            word-wrap: break-word;
            word-break: break-all;
            overflow-wrap: break-word;
        }
        
        /* 不符合情况区域 */
        .non-conformance-cell {
            padding: 15px;
            height: auto;
            min-height: 300px;
            vertical-align: top;
        }
        
        .non-conformance-cell.expanded {
            min-height: 320px;
        }
        
        .checkbox-group {
            margin: 0;
        }
        
        .checkbox-item {
            display: flex;
            align-items: flex-start;
            margin: 10px 0;
            line-height: 1.6;
        }
        
        .checkbox {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 1px solid #000;
            margin-right: 10px;
            flex-shrink: 0;
            position: relative;
            top: 2px;
        }
        
        .checkbox.checked::after {
            content: "✓";
            position: absolute;
            left: 2px;
            top: -2px;
            font-size: 14px;
            font-weight: bold;
        }
        
        .checkbox-text {
            flex: 1;
        }
        
        .recommendations-area {
            width: 100%;
            min-height: 200px;
            margin-top: 15px;
            padding: 0;
            font-size: 14px;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: break-all;
            overflow-wrap: break-word;
            border: none;
        }
        
        .recommendations-area.auto-size {
            font-size: 14px;
        }
        
        .recommendations-area.size-small {
            font-size: 12px;
            line-height: 1.4;
        }
        
        .recommendations-area.size-smaller {
            font-size: 10px;
            line-height: 1.3;
        }
        
        .recommendations-area.size-tiny {
            font-size: 8px;
            line-height: 1.2;
        }
        
        /* 底部签名行 */
        .signature-row td {
            height: auto;
            min-height: 45px;
            text-align: left;
            padding: 10px 15px;
            word-wrap: break-word;
            word-break: break-all;
            overflow-wrap: break-word;
        }
        
        .signature-label {
            font-weight: normal;
        }
        
        .signature-image {
            max-width: 100px;
            max-height: 40px;
        }
        
        /* 最后两行 */
        .org-row td {
            height: auto;
            min-height: 40px;
            padding: 8px 15px;
            word-wrap: break-word;
            word-break: break-all;
            overflow-wrap: break-word;
        }
        
        .org-left {
            width: 65%;
        }
        
        .org-right {
            width: 35%;
        }
    </style>
</head>
<body>
    <div class="document">
        <div class="header">
            <h1>电梯自行检测备忘录</h1>
        </div>
        
        <div class="memo-number">
            编号：{{memo_number}}
        </div>
        
        <table class="main-table">
            <!-- 第一行：使用单位名称 -->
            <tr class="row-single">
                <td class="label-cell">使用单位名称</td>
                <td class="value-cell" colspan="3">{{user_unit_name}}</td>
            </tr>
            
            <!-- 第二行：安装地点 和 设备品种 -->
            <tr>
                <td class="half-label">安装地点</td>
                <td class="half-cell">{{installation_location}}</td>
                <td class="half-label">设备品种</td>
                <td class="half-cell">{{equipment_type}}</td>
            </tr>
            
            <!-- 第三行：产品编号 和 使用登记证编号 -->
            <tr>
                <td class="half-label">产品编号</td>
                <td class="half-cell">{{product_number}}</td>
                <td class="half-label-wide">使用登记证编号</td>
                <td class="half-cell-narrow">{{registration_cert_no}}</td>
            </tr>
            
            <!-- 第四行：检测依据 -->
            <tr class="detection-basis-row">
                <td class="label-cell">检测依据</td>
                <td colspan="3" style="padding-left: 15px;">《电梯自行检测规则》（TSG T7008—2023）</td>
            </tr>
            
            <!-- 第五行：不符合情况及相关建议 -->
            <tr>
                <td colspan="4" class="non-conformance-cell {{non_conformance_cell_class}}">
                    <div style="margin-bottom: 10px;">不符合情况及相关建议：</div>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <span class="checkbox" id="checkbox-0"></span>
                            <span class="checkbox-text">该电梯存在不符合，建议立即整改。</span>
                        </div>
                        <div class="checkbox-item">
                            <span class="checkbox" id="checkbox-1"></span>
                            <span class="checkbox-text">该电梯存在较严重的不符合，建议立即停用整改。</span>
                        </div>
                        <div class="checkbox-item">
                            <span class="checkbox" id="checkbox-2"></span>
                            <span class="checkbox-text">无。</span>
                        </div>
                    </div>
                    <div class="recommendations-area {{recommendations_class}}" style="{{recommendations_display}}">{{recommendations}}</div>
                </td>
            </tr>
            
            <!-- 第六行：检测人员和检测日期 -->
            <tr class="signature-row">
                <td colspan="2" style="width: 50%;">
                    检测人员：{{tester_signature}}
                </td>
                <td colspan="2" style="width: 50%;">
                    检测日期：{{inspection_date_formatted}}
                </td>
            </tr>
            
            <!-- 第七行：检测单位名称和核准证号 -->
            <tr class="org-row">
                <td colspan="2" class="org-left">
                    检测单位名称：中安检测集团（湖北）有限公司
                </td>
                <td colspan="2" class="org-right">
                    核准证号/许可证号：TS7VⅡ2018-2027
                </td>
            </tr>
            
            <!-- 第八行：使用单位代表和签收日期 -->
            <tr class="org-row">
                <td colspan="2" class="org-left">
                    使用单位代表：{{representative_signature_display}}
                </td>
                <td colspan="2" class="org-right">
                    签收日期：{{signing_date_formatted}}
                </td>
            </tr>
        </table>
    </div>
    
    <script>
        // 根据不符合情况状态设置复选框
        const nonConformanceStatus = parseInt('{{non_conformance_status_raw}}');
        
        if (nonConformanceStatus === 1) {
            document.getElementById('checkbox-0').classList.add('checked');
        } else if (nonConformanceStatus === 2) {
            document.getElementById('checkbox-1').classList.add('checked');
        } else if (nonConformanceStatus === 0) {
            document.getElementById('checkbox-2').classList.add('checked');
        }
        
    </script>
</body>
</html>